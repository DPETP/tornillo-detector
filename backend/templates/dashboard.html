<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BGH - Dashboard</title>
    <link rel="stylesheet" href="/css/dashboard.css">
    <!-- El guardián de autenticación se carga primero para proteger la ruta -->
    <script src="/js/authGuard.js"></script>
</head>
<body class="dashboard-page">
    <div class="dashboard-container">
        <!-- SIDEBAR -->
        <aside class="sidebar">
            <div class="sidebar-top">
                <div class="user-profile">
                    <div class="user-info">
                        <!-- ID AÑADIDO para actualizar con JS -->
                        <span id="user-info-name">Usuario</span>
                        <!-- ID AÑADIDO para actualizar con JS -->
                        <small id="user-info-team">Team</small>
                    </div>
                </div>
            </div>
            
            <nav class="sidebar-nav">
                <!-- IDs AÑADIDOS y href cambiado para control con JS -->
                <a href="#" id="nav-dashboard" class="nav-item active">
                    <span class="icon">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="3" width="7" height="7"/>
                            <rect x="14" y="3" width="7" height="7"/>
                            <rect x="14" y="14" width="7" height="7"/>
                            <rect x="3" y="14" width="7" height="7"/>
                        </svg>
                    </span> Dashboard
                </a>
                <a href="#" id="nav-detection" class="nav-item">
                    <span class="icon">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M23 7l-7 5 7 5V7z"/>
                            <rect x="1" y="5" width="15" height="14" rx="2" ry="2"/>
                        </svg>
                    </span> Detección
                </a>
                <a href="#" id="nav-reportes" class="nav-item">
                    <span class="icon">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                            <polyline points="14 2 14 8 20 8"/>
                            <line x1="16" y1="13" x2="8" y2="13"/>
                            <line x1="16" y1="17" x2="8" y2="17"/>
                            <polyline points="10 9 9 9 8 9"/>
                        </svg>
                    </span> Reportes
                </a>
                <a href="#" id="nav-config" class="nav-item">
                    <span class="icon">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="3"/>
                            <path d="M12 1v6m0 6v6m5.656-13.656l-4.242 4.242m-2.828 2.828l-4.242 4.242m16.97-5.656l-6 0m-6 0l-6 0m13.656 5.656l-4.242-4.242m-2.828-2.828l-4.242-4.242"/>
                        </svg>
                    </span> Configuración
                </a>
            </nav>
            
            <div class="sidebar-bottom">
                <!-- El ID ya estaba correcto -->
                <button id="logoutBtn" class="btn-logout">
                    <span class="icon">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                            <polyline points="16 17 21 12 16 7"/>
                            <line x1="21" y1="12" x2="9" y2="12"/>
                        </svg>
                    </span> Cerrar Sesión
                </button>
            </div>
        </aside>

        <!-- MAIN CONTENT -->
        <main class="main-content">
            <!-- HEADER -->
            <header class="dashboard-header">
                <h1>Control de calidad – Tornillos Philips (Visión IA)</h1>
                <div class="header-search">
                    <input type="text" placeholder="Search" class="search-input">
                </div>
            </header>

            <!-- CONTENT -->
            <div class="dashboard-content">
                <!-- TOP CARDS -->
                <div class="cards-grid">
                    <div class="card">
                        <div class="card-label">Equipos Inspeccionados</div>
                        <!-- ID AÑADIDO para actualizar con JS -->
                        <div class="card-value" id="kpi-inspeccionados">0</div>
                    </div>
                    <div class="card">
                        <div class="card-label">Equipos PASS</div>
                        <!-- ID AÑADIDO para actualizar con JS -->
                        <div class="card-value success" id="kpi-pass">0</div>
                    </div>
                    <div class="card">
                        <div class="card-label">Equipos FAIL</div>
                        <!-- ID AÑADIDO para actualizar con JS -->
                        <div class="card-value error" id="kpi-fail">0</div>
                    </div>
                    <div class="card">
                        <div class="card-label">Latencia Promedio</div>
                        <!-- ID AÑADIDO para actualizar con JS -->
                        <div class="card-value" id="kpi-latencia">0.00 s</div>
                    </div>
                </div>

                <!-- CHARTS SECTION -->
                <div class="charts-section">
                    <!-- CHART 1 -->
                    <div class="chart-container">
                        <h3>Detecciones por Quarter</h3>
                        <!-- El ID del canvas ya estaba correcto -->
                        <canvas id="quarterChart"></canvas>
                    </div>

                    <!-- RIGHT SIDEBAR (estos valores son estáticos por ahora) -->
                    <div class="right-sidebar">
                        <div class="info-box">
                            <label>Latencia Promedio</label>
                            <span class="info-value">0,87 s</span>
                        </div>
                        <div class="info-box">
                            <label>Estado de Cámaras</label>
                            <span class="info-value success">Conexión OK</span>
                        </div>
                        <div class="info-box">
                            <label>Up time</label>
                            <span class="info-value">99,3 %</span>
                        </div>
                    </div>
                </div>

                <!-- LOGO -->
                <div class="dashboard-logo">
                    <img src="/assets/logo.png" alt="BGH Logo" style="max-width: 200px;">
                </div>

                <!-- BOTTOM CHARTS -->
                <div class="bottom-charts">
                    <div class="small-chart">
                        <h4>Distribución de Detecciones</h4>
                        <!-- El ID del canvas ya estaba correcto -->
                        <canvas id="distributionChart"></canvas>
                    </div>
                    <div class="small-chart">
                        <h4>Tendencia Mensual</h4>
                        <!-- El ID del canvas ya estaba correcto -->
                        <canvas id="trendChart"></canvas>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- SCRIPTS CARGADOS AL FINAL EN ORDEN CORRECTO -->
    <script src="/js/api.js"></script>
    <script src="/js/dashboard.js"></script>
    <script src="/js/navigation.js"></script>
</body>
</html>