<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuraci√≥n - Control de Calidad</title>
    <link rel="stylesheet" href="/css/admin.css"> <!-- Aseg√∫rate que la ruta a tu CSS es correcta -->
    <script src="/js/authGuard.js"></script>
</head>
<body>
    <div class="container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="logo">
                <span class="logo-icon">üîß</span>
                <div><div class="logo-text">Configuraci√≥n</div><div class="logo-subtext">Admin</div></div>
            </div>
            <button id="nav-dashboard" class="menu-item-special"><span class="icon">üìä</span> Volver al Dashboard</button>
            <nav class="menu">
                <button class="menu-item active" data-section="usuarios"><span class="icon">üë•</span> Usuarios</button>
                <button class="menu-item" data-section="modelos"><span class="icon">üìã</span> Modelos AA</button>
                <button class="menu-item" data-section="motores"><span class="icon">‚öôÔ∏è</span> Motores IA</button>
                <button class="menu-item" data-section="configuracion"><span class="icon">‚ö°</span> Configuraci√≥n Global</button>
            </nav>
            <div class="bgh-logo"><img src="/assets/bgh-logo.png" alt="BGH Logo"></div>
            <button class="logout-btn"><span class="icon">üö™</span> Cerrar Sesi√≥n</button>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="header"><h1>Panel de Configuraci√≥n</h1></header>
            <div id="alerts-container"></div>

            <!-- Secci√≥n de Usuarios -->
            <section id="usuarios" class="config-section active-section">
                <div class="section-header"><h3>Gesti√≥n de Usuarios</h3><button class="btn btn-primary" data-action="open-user-modal">+ Crear Usuario</button></div>
                <table class="table" id="usuarios-table">
                    <thead><tr><th>Usuario</th><th>Email</th><th>Rol</th><th>Equipo</th><th>Estado</th><th>Acciones</th></tr></thead>
                    <tbody id="usuarios-tbody"></tbody>
                </table>
            </section>

            <!-- Secci√≥n de Modelos AA -->
            <section id="modelos" class="config-section">
                <div class="section-header"><h3>Modelos de Aire Acondicionado</h3><button class="btn btn-primary" data-action="open-model-modal">+ Crear Modelo</button></div>
                <table class="table" id="modelos-table">
                    <thead><tr><th>Nombre</th><th>Tornillos</th><th>Confianza</th><th>Tiempo Ciclo (s)</th><th>Motor IA</th><th>Estado</th><th>Acciones</th></tr></thead>
                    <tbody id="modelos-tbody"></tbody>
                </table>
            </section>

            <!-- Secci√≥n de Motores IA -->
            <section id="motores" class="config-section">
                <div class="section-header"><h3>Motores de IA</h3><button class="btn btn-primary" data-action="open-engine-modal">+ Cargar Motor IA</button></div>
                <table class="table" id="motores-table">
                    <thead><tr><th>Tipo</th><th>Versi√≥n</th><th>Tama√±o (MB)</th><th>Estado</th><th>Acciones</th></tr></thead>
                    <tbody id="motores-tbody"></tbody>
                </table>
            </section>

            <!-- Secci√≥n de Configuraci√≥n Global -->
            <section id="configuracion" class="config-section">
                <h3>Configuraci√≥n Global</h3>
                <div class="form-group"><label for="modelo-activo">Modelo de AA Activo para Detecci√≥n:</label><select id="modelo-activo"></select></div>
                <div class="form-group"><label><input type="checkbox" id="registro-publico"> Permitir Registro P√∫blico</label></div>
                <button class="btn btn-primary" id="btn-guardar-settings">Guardar Configuraci√≥n</button>
            </section>
        </main>
    </div>

    <!-- Modales -->
    <div id="userModal" class="modal"><div class="modal-content"><div class="modal-header"><h2 id="userModalTitle">Crear Usuario</h2><button class="close" data-action="close-modal">&times;</button></div><form id="userForm"><div class="form-group"><label for="username">Usuario:</label><input type="text" id="username" required></div><div class="form-group"><label for="email">Email:</label><input type="email" id="email" required></div><div class="form-group"><label for="password">Contrase√±a (dejar en blanco para no cambiar):</label><input type="password" id="password"></div><div class="form-group"><label for="role">Rol:</label><select id="role"><option value="operario">Operario</option><option value="soporte_tecnico">Soporte T√©cnico</option><option value="admin">Administrador</option></select></div><div class="form-group"><label for="team">Equipo:</label><input type="text" id="team" value="Default Team"></div><div class="button-group"><button type="button" class="btn btn-secondary" data-action="close-modal">Cancelar</button><button type="submit" class="btn btn-primary">Guardar</button></div></form></div></div>
    
    <div id="modelModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modelModalTitle">Crear Modelo AA</h2>
                <button class="close" data-action="close-modal">&times;</button>
            </div>
            <form id="modelForm">
                <div class="form-group"><label for="nombre-modelo">Nombre:</label><input type="text" id="nombre-modelo" required></div>
                <div class="form-group"><label for="descripcion-modelo">Descripci√≥n:</label><textarea id="descripcion-modelo"></textarea></div>
                <div class="form-group"><label for="target-tornillos">Tornillos Objetivo:</label><input type="number" id="target-tornillos" min="1" value="1" required></div>
                <div class="form-group"><label for="confidence-threshold">Umbral de Confianza:</label><input type="number" id="confidence-threshold" min="0.1" max="1" step="0.05" value="0.5" required></div>
                
                <!-- === CAMBIO IMPORTANTE AQU√ç === -->
                <div class="form-group">
                    <label for="inspection-cycle-time">Tiempo de Inspecci√≥n (segundos):</label>
                    <input type="number" id="inspection-cycle-time" min="5" max="120" value="20" required>
                </div>
                
                <div class="form-group"><label for="motor-select">Motor IA:</label><select id="motor-select" required></select></div>
                <div class="button-group"><button type="button" class="btn btn-secondary" data-action="close-modal">Cancelar</button><button type="submit" class="btn btn-primary">Guardar</button></div>
            </form>
        </div>
    </div>
    
    <div id="engineModal" class="modal"><div class="modal-content"><div class="modal-header"><h2 id="engineModalTitle">Cargar Motor IA</h2><button class="close" data-action="close-modal">&times;</button></div><form id="engineForm"><div class="form-group"><label for="engine-type">Tipo de Motor:</label><select id="engine-type" required><option value="yolo">YOLO</option><option value="rtdetr">RT-DETR</option></select></div><div class="form-group"><label for="engine-version">Versi√≥n:</label><input type="text" id="engine-version" placeholder="Ej: 8n, 8s, L" required></div><div class="form-group"><label for="engine-file">Archivo (.pt):</label><input type="file" id="engine-file" accept=".pt" required></div><div class="form-group"><label for="engine-desc">Descripci√≥n:</label><textarea id="engine-desc"></textarea></div><div class="button-group"><button type="button" class="btn btn-secondary" data-action="close-modal">Cancelar</button><button type="submit" class="btn btn-primary">Cargar</button></div></form></div></div>

    <!-- Scripts -->
    <script src="/js/api.js"></script>
    <script src="/js/navigation.js"></script>
    <script src="/js/admin.js"></script>
</body>
</html>