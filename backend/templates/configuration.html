<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuración - Control de Calidad</title>
    <link rel="stylesheet" href="/css/admin.css">
    <script src="/js/authGuard.js"></script>
</head>
<body>
    <div class="container">
        <aside class="sidebar">
            <div class="logo">
                <span>
                    <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3"/>
                        <path d="M12 1v6m0 6v6m5.656-13.656l-4.242 4.242m-2.828 2.828l-4.242 4.242m16.97-5.656l-6 0m-6 0l-6 0m13.656 5.656l-4.242-4.242m-2.828-2.828l-4.242-4.242"/>
                    </svg>
                </span>
                <div><div class="logo-text">Configuración</div><div class="logo-subtext">Admin</div></div>
            </div>
            <button id="nav-dashboard" class="menu-item-special">
                <span>
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                        <line x1="19" y1="12" x2="5" y2="12"/>
                        <polyline points="12 19 5 12 12 5"/>
                    </svg>
                </span> Volver al Dashboard
            </button>
            <nav class="menu">
                <button class="menu-item active" data-section="usuarios">
                    <span>
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                            <circle cx="12" cy="7" r="4"/>
                        </svg>
                    </span> Usuarios
                </button>
                <button class="menu-item" data-section="modelos">
                    <span>
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/>
                            <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/>
                        </svg>
                    </span> Modelos AA
                </button>
                <button class="menu-item" data-section="motores">
                    <span>
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="3"/>
                            <path d="M12 1v6m0 6v6m5.656-13.656l-4.242 4.242m-2.828 2.828l-4.242 4.242m16.97-5.656l-6 0m-6 0l-6 0m13.656 5.656l-4.242-4.242m-2.828-2.828l-4.242-4.242"/>
                        </svg>
                    </span> Motores IA
                </button>
                <button class="menu-item" data-section="configuracion">
                    <span>
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>
                        </svg>
                    </span> Configuración Global
                </button>
            </nav>
            <div class="bgh-logo"><img src="/assets/bgh-logo.png" alt="BGH Logo"></div>
            <button class="logout-btn">
                <span>
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                        <polyline points="16 17 21 12 16 7"/>
                        <line x1="21" y1="12" x2="9" y2="12"/>
                    </svg>
                </span> Cerrar Sesión
            </button>
        </aside>

        <main class="main-content">
            <header class="header"><h1>Panel de Configuración</h1></header>
            <div id="alerts-container"></div>
            <section id="usuarios" class="config-section active-section"><div class="section-header"><h3>Gestión de Usuarios</h3><button class="btn btn-primary" data-action="open-user-modal">+ Crear Usuario</button></div><table class="table" id="usuarios-table"><thead><tr><th>Usuario</th><th>Email</th><th>Rol</th><th>Equipo</th><th>Estado</th><th>Acciones</th></tr></thead><tbody id="usuarios-tbody"></tbody></table></section>
            <section id="modelos" class="config-section"><div class="section-header"><h3>Modelos de Aire Acondicionado</h3><button class="btn btn-primary" data-action="open-model-modal">+ Crear Modelo</button></div><table class="table" id="modelos-table"><thead><tr><th>Nombre</th><th>Tornillos</th><th>Confianza</th><th>Tiempo Ciclo (s)</th><th>Motor IA</th><th>Estado</th><th>Acciones</th></tr></thead><tbody id="modelos-tbody"></tbody></table></section>
            <section id="motores" class="config-section"><div class="section-header"><h3>Motores de IA</h3><button class="btn btn-primary" data-action="open-engine-modal">+ Cargar Motor IA</button></div><table class="table" id="motores-table"><thead><tr><th>Tipo</th><th>Versión</th><th>Tamaño (MB)</th><th>Estado</th><th>Acciones</th></tr></thead><tbody id="motores-tbody"></tbody></table></section>
            <section id="configuracion" class="config-section"><h3>Configuración Global</h3><div class="form-group"><label for="modelo-activo">Modelo de AA Activo:</label><select id="modelo-activo"></select></div><div class="form-group"><label><input type="checkbox" id="registro-publico"> Permitir Registro Público</label></div><button class="btn btn-primary" id="btn-guardar-settings">Guardar</button></section>
        </main>
    </div>

    <!-- Modales -->
    <div id="userModal" class="modal"><div class="modal-content"><div class="modal-header"><h2 id="userModalTitle">Crear Usuario</h2><button class="close" data-action="close-modal">&times;</button></div><form id="userForm"><div class="form-group"><label for="username">Usuario:</label><input type="text" id="username" required></div><div class="form-group"><label for="email">Email:</label><input type="email" id="email" required></div><div class="form-group"><label for="password">Contraseña:</label><input type="password" id="password"></div><div class="form-group"><label for="role">Rol:</label><select id="role"><option value="operario">Operario</option><option value="soporte_tecnico">Soporte Técnico</option><option value="admin">Administrador</option></select></div><div class="form-group"><label for="team">Equipo:</label><input type="text" id="team" value="Default Team"></div><div class="button-group"><button type="button" class="btn btn-secondary" data-action="close-modal">Cancelar</button><button type="submit" class="btn btn-primary">Guardar</button></div></form></div></div>
    <div id="modelModal" class="modal"><div class="modal-content"><div class="modal-header"><h2 id="modelModalTitle">Crear Modelo AA</h2><button class="close" data-action="close-modal">&times;</button></div><form id="modelForm"><div class="form-group"><label for="nombre-modelo">Nombre:</label><input type="text" id="nombre-modelo" required></div><div class="form-group"><label for="descripcion-modelo">Descripción:</label><textarea id="descripcion-modelo"></textarea></div><div class="form-group"><label for="target-tornillos">Tornillos Obj.:</label><input type="number" id="target-tornillos" min="1" value="1" required></div><div class="form-group"><label for="confidence-threshold">Confianza:</label><input type="number" id="confidence-threshold" min="0.1" max="1" step="0.05" value="0.5" required></div><div class="form-group"><label for="inspection-cycle-time">Tiempo Ciclo (s):</label><input type="number" id="inspection-cycle-time" min="5" max="120" value="20" required></div><div class="form-group"><label for="motor-select">Motor IA:</label><select id="motor-select" required></select></div><div class="button-group"><button type="button" class="btn btn-secondary" data-action="close-modal">Cancelar</button><button type="submit" class="btn btn-primary">Guardar</button></div></form></div></div>
    <div id="engineModal" class="modal"><div class="modal-content"><div class="modal-header"><h2 id="engineModalTitle">Cargar Motor IA</h2><button class="close" data-action="close-modal">&times;</button></div><form id="engineForm"><div class="form-group"><label for="engine-type">Tipo:</label><select id="engine-type" name="tipo" required><option value="">-- Seleccionar --</option><option value="yolov5">YOLOv5</option><option value="yolov8">YOLOv8</option><option value="yolov11">YOLOv11</option><option value="rtdetr">RT-DETR</option><option value="efficientdet">EfficientDet</option><option value="maskrcnn">Mask R-CNN</option></select></div><div class="form-group"><label for="engine-version">Versión:</label><input type="text" id="engine-version" name="version" placeholder="ej: 8.0, 11.2, D7" required></div><div class="form-group"><label for="engine-file">Archivo (.pt):</label><input type="file" id="engine-file" name="archivo" accept=".pt,.pth,.weights" required><small style="color: #666; font-size: 0.9em;">Formatos: .pt (YOLO/RT-DETR), .pth (EfficientDet), .weights (Mask R-CNN)</small></div><div class="form-group"><label for="engine-desc">Descripción:</label><textarea id="engine-desc" name="descripcion" placeholder="Ej: Modelo entrenado con dataset v2, 500 epochs"></textarea></div><div class="button-group"><button type="button" class="btn btn-secondary" data-action="close-modal">Cancelar</button><button type="submit" class="btn btn-primary">Cargar</button></div></form></div></div>

    <!-- Scripts -->
    <script src="/js/api.js"></script>
    <script src="/js/navigation.js"></script>
    <script src="/js/admin.js"></script>
</body>
</html>